<?php include_once('php_display_fn/formErrorsMsg.php');?>

<!DOCTYPE html>
<html>
	<head>
		<title>EAV - Paramètres</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<link rel="stylesheet" type="text/css" href="vue/style.css" />
		<link href='http://fonts.googleapis.com/css?family=Orbitron' rel='stylesheet' type='text/css'>
		<script type="text/javascript" src="vue/jquery/js/jquery.min.js"></script>
		<script type="text/javascript" src="vue/jquery/js/jquery.validate.js"></script>
		<script type="text/javascript" src="vue/jquery/js/jquery.additional-methods.min.js"></script>

		<style type="text/css"></style>
		
		
		<script type="text/javascript">
			$(document).ready(function() {
				$('#form1').validate({
					rules: {
						pass_actuel: { required:true },
						pass_nouveau: { required:true, minlength : 5, maxlength:20},
						pass_confirm: { required:true, equalTo : "#pass_nouveau"}
					},
					messages: {
						pass_actuel: {
							required: " Ce champ est obligatoire"
						},
						pass_nouveau: {
							required: " Ce champ est obligatoire",
							minlength: " Ce champ doit contenir plus de 4 caractères",
							maxlength: " Ce champ doit contenir moins de 20 caractères"
						},
						pass_confirm: {
							required: " Ce champ est obligatoire",
							required: " Ce champ est obligatoire",
							equalTo : " Les deux mots de passe doivent être identiques"
						}
					}
				});
				$('#form2').validate({
					rules: {
						pass_actuel: { required:true },
						mail: { required:true, email:true }
					},
					messages: {
						pass_actuel: {
							required: " Ce champ est obligatoire"
						},
						mail: {
							required: " Ce champ est obligatoire",
							email: " Ceci n'est pas une adresse e-mail valide"
						}
					}
				});
				$('#pass_nouveau, #email').keydown(function(e) { // Interdit les espaces dans le email et le password
					if (e.which == 32) {
						return false;
			  		}
				});
				$('#pass_nouveau').keyup(function() { // As same using keyup function for get user action in input
					var PasswordLength = $(this).val().length; // Get the password input using $(this)
					var PasswordStrength = $('#password_strength'); // Get the id of the password indicator display area
		
					if(PasswordLength <= 0) { // Check is less than 0
						PasswordStrength.html(''); // Empty the HTML
						PasswordStrength.removeClass('normal weak strong verystrong'); //Remove all the indicator classes
					}
					if(PasswordLength > 0 && PasswordLength < 5) { // If string length less than 4 add 'weak' class
						PasswordStrength.html('Faible');
						PasswordStrength.removeClass('normal strong verystrong').addClass('weak');
					}
					if(PasswordLength > 5 && PasswordLength < 8) { // If string length greater than 4 and less than 8 add 'normal' class
						PasswordStrength.html('Correct');
						PasswordStrength.removeClass('weak strong verystrong').addClass('normal');			
					}	
					if(PasswordLength >= 8 && PasswordLength < 12) { // If string length greater than 8 and less than 12 add 'strong' class
						PasswordStrength.html('Fort');
						PasswordStrength.removeClass('weak normal verystrong').addClass('strong');
					}
					if(PasswordLength >= 12) { // If string length greater than 12 add 'verystrong' class
						PasswordStrength.html('Très fort');
						PasswordStrength.removeClass('weak normal strong').addClass('verystrong');
					}
				});		
			});
		</script>
	</head>

	<body>
		<!-- Menu -->
		<?php include ('top_menu.php')?>
		<!-- Fin du Menu -->
	
		<div id="page" style="width: 60%">
			<fieldset style="padding-bottom:50px; width: 100%;">
				<legend class="titre">Paramètres du compte</legend>
				<?php if(isset($validator_result[1])) formErrorsMsg($validator_result[1]); ?>
				<p>
					Nom d'utilisateur : <?php echo htmlentities(trim($_SESSION['login'])); ?>
				</p>
				<form id="form1" action="parametres.php" method="post">
					<fieldset class="sous-champ" style="text-align:left">
						<legend>Changer mon mot de passe</legend>
						<span>Mot de passe actuel: </span>
						<input type="password" name="pass_actuel" value=""><br />
						<span>Nouveau mot de passe : </span>
						<input type="password"  id="pass_nouveau" name="pass_nouveau" value=""><br />
						<span></span><div class="password_strength" id="password_strength"></div><br />
						<span>Confirmation du mot de passe : </span>
						<input type="password" name="pass_confirm" value=""><br />
					</fieldset>
					<input class="special_btn" type="submit" name="modification_mdp" value="Modifier">
				</form>
				<form id="form2" action="parametres.php" method="post">
					<fieldset class="sous-champ"  style="text-align:left">
						<legend>Changer mon adresse email</legend>
						<span>Mot de passe actuel: </span>
						<input type="password" name="pass_actuel" value=""><br />
						<span>Email : </span>
						<input type="email" id="email" name="mail" value="<?php if (isset($_POST['mail'])) echo htmlentities(trim($_POST['mail'])); ?>"><br />
					</fieldset class="sous-champ"  style="text-align:left">
						<input class="special_btn" type="submit" name="modification_email" value="Modifier">
				</form>
				<form id="form3" action="parametres.php">
					<fieldset class="sous-champ" style="text-align:left">
						<legend>Changer ma base de données locale (Aix-Marseille Université)</legend>
						<span>Identifiant Mysql : </span>
						<input type="text" name="mysql_login" /><br />
						<span>Mot de passe Mysql : </span>
						<input type="password" name="mysql_pass" /><br />
						<div class="info">Ce champ facultatif est reservé aux étudiants et aux personnels de l'AMU. Il vous permettra de sauvegarder vos requêtes Ensembl sur votre base de données locale si elle est activée. Si ce n'est pas le cas, consultez la DOSICALU.</div>
					</fieldset>
			</fieldset>
		</div>
		
		<!-- Pied de page -->
		<?php include ('footer.php')?>
		<!-- Fin du pied de page -->
	</body>
</html>
