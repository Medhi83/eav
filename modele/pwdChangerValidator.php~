<?php

function pwdChangerValidator($arrayVar){
	include_once('varIsSet.php');
	include_once('nb_membre.php');
	$login = $_SESSION['login'];
	$salt = 'PeEa3B25$ANZQ_7PmFYMtJV#2FuS*DteaFZ4MÃ©zaMpXa-ZH2TucFG6';

	$errors_table = array();
	$variables_obligatoires = array($arrayVar['pass_actuel'],
				$arrayVar['pass_nouveau'],
				$arrayVar['pass_confirm']);

	if (!varIsSet($variables_obligatoires)){
		array_push($errors_table, 'empty field');
	}
	if (strlen($arrayVar['pass_nouveau']) < 5 or strlen($arrayVar['pass_nouveau']) > 20) {
		array_push($errors_table, 'pwd size');
	}
	if ($arrayVar['pass_nouveau'] != $arrayVar['pass_confirm']) {
		array_push($errors_table, 'pass not equal');
	}
	if(nb_membre($login, md5($arrayVar['pass_actuel'].$salt.$login))[0] != 1){
		array_push($errors_table, 'pwd invalid');
	}

	if(empty($errors_table)) $result = true;
	else	$result = false;

	return array($result, $errors_table);
}
