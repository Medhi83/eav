<?php
// on teste si le visiteur a soumis le formulaire de connexion
if (isset($_POST['connexion']) && $_POST['connexion'] == 'Connexion') {
	if ((isset($_POST['login']) && !empty($_POST['login'])) && (isset($_POST['pass']) && !empty($_POST['pass']))) {

		// On récupère le mot de passe crypté du login
		$reponse = $base->query('SELECT COUNT(*) FROM membre WHERE login='.$base->quote($_POST['login']).' AND pass_md5='.$base->quote(md5($_POST['pass'])));
		$data = $reponse->fetch();

		// Si le mot de passe est correct, alors on démarre la session.
		if ($data[0] == 1) {
			if (!isset($_SESSION)) session_start();
			$_SESSION['login'] = $_POST['login'];
			header('Location:'.$_SERVER['PHP_SELF']);
			exit();
		}
		else {
			$erreur = 'Compte non reconnu.';
		}
	}
	else {
		$erreur = 'Au moins un des champs est vide.';
	}
}
